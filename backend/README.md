# AI 기반 웹 로그 이상 행위 탐지 시스템

## 📖 프로젝트 소개

이 프로젝트는 **오토인코더(Autoencoder)** 딥러닝 모델을 사용하여 웹 서버의 접근 로그(`access.log`)를 분석하고, 비정상적인 접근(해킹 시도, 시스템 오류 등)을 실시간으로 탐지하는 시스템입니다.

## ⚙️ 동작 원리

1.  **정상 패턴 학습**: 오토인코더는 정상적인 상태의 로그 데이터만을 학습합니다. 이 과정에서 모델은 정상 로그의 핵심적인 패턴을 압축하고(인코딩) 다시 원본 형태로 복원하는(디코딩) 방법을 배웁니다.
2.  **재구성 오류 계산**: 학습이 완료된 모델에 새로운 로그 데이터를 입력합니다.
    *   **정상 로그**: 모델이 이미 학습한 패턴이므로, 원본과 매우 유사하게 복원할 수 있습니다. 따라서 원본과 복원된 데이터 간의 차이(재구성 오류)는 매우 작습니다.
    *   **비정상 로그**: SQL 인젝션, XSS 공격 등과 같이 학습하지 않은 생소한 패턴이므로, 제대로 복원하지 못합니다. 따라서 재구성 오류가 매우 크게 발생합니다.
3.  **이상 행위 탐지**: 미리 설정된 임계값(Threshold)보다 재구성 오류가 큰 로그를 '비정상(공격 의심)'으로 판단합니다.

## 📂 프로젝트 구조

```
.
├── 📁 access.log              # (생성됨) 샘플 로그 파일
├── 📄 data_handler.py         # 데이터 로딩 및 전처리 모듈
├── 📄 autoencoder_model.py    # 오토인코더 모델 구조 정의
├── 📄 train.py                # 모델을 학습시키고 파일로 저장하는 스크립트
├── 📄 detect.py               # 학습된 모델로 이상 행위를 탐지하는 스크립트
├── 📄 anomaly_detector_model.h5 # (생성됨) 학습된 AI 모델 파일
├── 📄 scaler.gz               # (생성됨) 데이터 정규화 스케일러 파일
├── 📄 requirements.txt        # 실행에 필요한 라이브러리 목록
└── 📄 README.md               # 프로젝트 설명서
```

*   **`data_handler.py`**: 로그 파일을 읽고 파싱하여 AI가 학습할 수 있는 숫자 데이터(특징)로 변환합니다.
*   **`autoencoder_model.py`**: TensorFlow/Keras를 사용하여 오토인코더 딥러닝 모델을 정의합니다.
*   **`train.py`**: `data_handler.py`로 데이터를 준비하고, `autoencoder_model.py`로 모델을 만들어 학습시킵니다. 학습 결과물(`anomaly_detector_model.h5`, `scaler.gz`)을 저장합니다.
*   **`detect.py`**: 저장된 모델과 스케일러를 불러와 새로운 로그 파일에서 이상 행위를 탐지하고 결과를 출력합니다.

## 🛠️ 설치 방법

1.  **프로젝트 복제**
    ```bash
    git clone https://github.com/your-username/your-repo-name.git
    cd your-repo-name
    ```

2.  **필요한 라이브러리 설치**
    ```bash
    pip install -r requirements.txt
    ```

## 🚀 사용 방법

프로젝트는 **1단계: 학습**과 **2단계: 탐지**로 나누어 실행합니다.

### 1단계: 모델 학습시키기

먼저, AI 모델에게 정상 로그의 패턴을 학습시켜야 합니다. 아래 명령어를 실행하면 샘플 로그 파일(`access.log`)이 자동으로 생성되고, 이를 이용해 모델 학습이 진행됩니다.

```bash
python train.py
```

학습이 완료되면 `anomaly_detector_model.h5` (AI 모델)와 `scaler.gz` (데이터 전처리기) 파일이 생성됩니다. 이 과정은 최초 한 번만 수행하면 됩니다.

### 2단계: 이상 행위 탐지하기

학습된 모델을 사용하여 실제 로그 파일의 이상 행위를 탐지합니다. `train.py` 실행 시 생성된 `access.log` 파일을 대상으로 탐지하려면 아래와 같이 실행합니다.

```bash
python detect.py access.log
```

만약 다른 로그 파일을 검사하고 싶다면, 파일 경로를 인자로 넘겨주면 됩니다.

```bash
python detect.py /var/log/nginx/access.log
```

### ✨ 실행 결과 예시

`detect.py`를 실행하면 아래와 같이 탐지 결과가 출력됩니다. 재구성 오류(Reconstruction Error)가 임계값(Threshold)을 초과하는 로그들이 '비정상'으로 표시됩니다.

```
모델과 스케일러를 성공적으로 불러왔습니다.

--- 이상 행위 탐지 결과 ---
사용한 임계값(Threshold): 0.1
[!] 비정상 로그 탐지 (오류: 0.2517): GET /admin/config.php HTTP/1.1
[!] 비정상 로그 탐지 (오류: 0.4821): GET /search?q=<script>alert(1)</script> HTTP/1.1
[!] 비정상 로그 탐지 (오류: 0.3156): GET /index.php?page=../../../../etc/passwd HTTP/1.1
[!] 비정상 로그 탐지 (오류: 0.1889): POST /login.php HTTP/1.1
[!] 비정상 로그 탐지 (오류: 0.4112): GET /?id=1%27%20OR%20%271%27=%271 HTTP/1.1

총 5개의 비정상(공격 의심) 로그를 탐지했습니다.
```
